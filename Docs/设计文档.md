# 设计文档

## 任务概述

### 目标

设计一个能够让老师排课、学生选课的课程管理系统，系统包含课程管理的基本过程。覆盖了学生登录、查看、选课等各个环节，软件各个模块界面操作简单实用，老师的排课等各个模块。

### 需求分析

一个老师可以教授多门课，一门课可以由多个老师教授，老师教授一门课程的学生数量可以自己定，一个学生可以选择多门课并且每一门课都会有相应的成绩记录，一门课也可以被多个学生选择。学生只能有一个班级，但班级内可以有多个学生。一个部门可以有多个班级，但一个班级只属于一个部门。同一门课可能由同一个老师在不同的学年上。

## 总体设计

### 用户设计

#### 学生端

学生能够通过该界面管理个人信息、选择课程、查询成绩登操作。在管理个人信息界面中能够对初始的信息进行修改。能够查看自己的已选课程以及选择课程。

#### 教师端

教务工作人员通过该界面去管理个人信息、课程信息、部门信息和学生成绩。在管理个人信息处，能够对初始的信息进行修改，如修改生日、密码。在管理课程信息处，能够对已有的课程信息和课程计划进行保存或删除，同时也可以增加课程、课程计划、可选课程等，使教学资源得到合理分配。在管理部门信息处，能够查看所有部门的信息，在此基础上能够对部门信息进行删除，此外也能够另增加部门记录。在学生成绩管理处，能够针对不同课号录入学生的成绩，能够查看每个课号的课程所有学生的成绩。

### 接口设计

> 以下所有接口返回的格式为`{"status": "xxx", "data", []}`，下面**返回值**指的是data键中的值，如果返回值中写success表示data为空列表，则只需要看status键即可

- 学生端

  学生端主要的数据操作是增删改查，所以需要设计4个模块的接口供前端进行调用。

  1. 学生登录

     | 接口名   | 参数              | 参数类型      | 描述                                             | 返回值 |
     | -------- | ----------------- | ------------- | ------------------------------------------------ | ------ |
     | stuLogin | 学生学号,学生密码 | String,String | 根据传入的学生信息来返回对应学生数据库中的信息。 | userid |

  2. 学生个人信息

     | 接口名        | 参数                                           | 参数类型         | 描述                                 | 返回值                                 |
     | ------------- | ---------------------------------------------- | ---------------- | ------------------------------------ | -------------------------------------- |
     | updateStuInfo | userid,学生姓名,学生性别,年龄,出生日期(按顺序) | String(逗号隔开) | 根据传入的学生信息来修改数据库中的值 | "success"/"failure"(不合法返回failure) |
     | getStuInfo    | userid                                         | String           | 根据传入的学生学号返回对应学生的信息 | 学生信息(Json)                         |
     
  3. 学生成绩
  
     | 接口名      | 参数   | 参数类型 | 描述                                           | 返回值         |
     | ----------- | ------ | -------- | ---------------------------------------------- | -------------- |
     | getStuScore | userid | String   | 根据传入的学生信息来返回对应学生的所有课程成绩 | 学生成绩(Json) |
  
  4. 学生课程
  
     | 接口名              | 参数                  | 参数类型 | 描述                                                         | 返回值         |
     | ------------------- | --------------------- | -------- | ------------------------------------------------------------ | -------------- |
     | stu/getCoureseTable | userid                | String   | 根据传入的学生学号返回对应学生的已选课程，先拉课程表，筛选**课程代码**不在**选课表和课程计划自然连接**的课程代码集合 | 课程信息(Json) |
     | addStuTabel         | userid,已选中课程课号 | String   | 根据传入的学生学号和选中的课程添加选课信息                   | "success"      |
     | delStuCourse        | userid,已选中课程课号 | String   | 根据传入的学生学号和选中的课程进行退课                       | "success"      |
     | stu/selectCourse    | userid,课号           | String   | 插入选课关系表中，课号+学号，成绩随意，判重                  | "success"      |
     | stu/isChoose        | 课程代码              | String   | 从计划表中，筛选课程代号与传入代号相同的记录，展示课程计划信息以及老师信息 |                |
  
- 教师端

  教师端主要的数据操作为添加、删除课程和获取老师的部门信息，以及对学生成绩的上传录入和查询，以及对教师个人信息的查看和修改。

  1. 教师登录

     | 接口名       | 参数       | 参数类型      | 描述                                                 | 返回值            |
     | ------------ | ---------- | ------------- | ---------------------------------------------------- | ----------------- |
     | teacherLogin | tno,passwd | String,String | 根据传入的教师工号和密码进行判断，返回是否登录成功。 | "sucess"/"failed" |

  2. 教师个人信息

     | 接口名            | 参数                              | 参数类型 | 描述                                           | 返回值             |
     | ----------------- | --------------------------------- | -------- | ---------------------------------------------- | ------------------ |
     | getTeacherInfo    | userid                            | String   | 根据传入的教师工号返回对应教师的个人信息       | 教师个人信息(Json) |
     | updateTeacherInfo | userid,教师姓名,学生性别,出生日期 | Json     | 根据传入的教师工号和个人信息更新教师的个人信息 | "success"          |

  3. 学生成绩管理

     | 接口名              | 参数                                | 参数类型 | 描述                                           | 返回值           |
     | ------------------- | ----------------------------------- | -------- | ---------------------------------------------- | ---------------- |
     | addStuScore         | 课程序号,学生学号,平时成绩,考试成绩 | Json     | 根据传入的参数对学生的成绩进行更新             | "success"        |
     | addStuScoreWithFile | 课程序号,csv文件                    | Json     | 根据传入的课程序号批量添加学生成绩             | "success"        |
     | getStuScores        | 课程序号                            | String   | 根据传入的课程序号返回对应课程的所有学生的成绩 | 学生成绩单(list) |

  4. 教学课程管理

     | 接口名                         | 参数                                                | 参数类型 | 描述                                                         | 返回值           |
     | ------------------------------ | --------------------------------------------------- | -------- | ------------------------------------------------------------ | ---------------- |
     | delCourseScheduleTable         | 课程序号                                            | String   | 根据传入的课程序号删除对应课程计划                           | "success"        |
     | delCourse                      | 课程序号                                            | String   | 根据传入课程序号删除对应课程                                 | "success"        |
     | addNewCourseSchedule           | userid,课程序号,课程代码,授课学期,课程开课时间,学分 | Json     | 1.向课程计划表中添加课程计划记录，记得判重。2. 向讲授表中插入工号，课号记录。 | "success"        |
     | teacher/getCourseScheduleTable | userid                                              | String   | 先拿到teacher的tno，然后在teach表中搜索tno对应的所有cno结果重命名为a，最后返回schedule中cno在a里面的记录，**获取老师教的课程计划记录** | 课程计划表(list) |
     | addNewCourse                   | 课程代码,课程名称,学分                              | Json     | 根据传入的参数添加新课程                                     | "success"        |
     | getTeachTable                  | userid                                              | None     | 返回当前用户教的所有课程                                     | 课程列表(list)   |

- 通用接口

  | 接口名                 | 参数 | 参数类型 | 描述             | 返回值       |
  | ---------------------- | ---- | -------- | ---------------- | ------------ |
  | getCourseTable         | None | None     | 返回课选课程     | 课选课程信息 |
  | getCourseScheduleTable | None | None     | 返回课程计划信息 | 课程计划信息 |
  
  
